
===========================================================

　　　簡易字幕記述言語 MMTScript Ver.1.2 仕様書

　　　　　　　　　　制作：そぼろ
　　　　　　　　　更新日：2011/9/22

===========================================================

■はじめに

MMTScript は、MMD＆MME向け字幕エフェクト生成ツール「MikuMikuTelop」
で使用するために策定された簡易字幕記述言語です。
極めて単純な機能しかありませんが、その分習得が容易で
効率的に字幕を作成できることを目標としています。


------------------------------------------------------------

■基本フォーマット

MMTScriptは大別して以下の要素からなります。

・テキストコマンド
・システムコマンド
・コメント

それぞれの詳細は後述します。

ファイル形式(拡張子)は txt または mmt を使用します。
mmtファイルはMMTScriptファイルであることを明示したい場合に使用しますが、
内容は通常のテキストファイルと変わりありません。
メモ帳で開いて編集することができます。

文字コードはShift-JISまたはBOM付きのUTF-8が使用できます。
改行コードはCR+LF（Windows標準）を使用します。

コマンドとコマンドの間の空白行は無視されます。


------------------------------------------------------------

■テキストコマンド

　●文法

字幕として表示するテキストを指定するコマンドです。
"@"(アットマーク) + 表示時刻 + ","(カンマ) + 表示長さ
のように指定します。

次の行からの内容が字幕として表示する内容となります。
書かれた内容が改行も含めてそのまま表示されます。
ただし文頭と文末の空白行は無視されます。意図的に残したい場合は
スペースを入れてください。

テキストコマンドの終わりは次のうちどれかです。
・次のテキストコマンド
・次のシステムコマンド
・ファイルの終わり

表示時刻と表示長さの前後に半角スペースまたはタブが含まれていても構いません。
本文中で"@"(アットマーク)を使用したい場合は"@@"のように２つ重ねてください。

MMTScriptには、最低一個のテキストコマンドが含まれていなければなりません。

　●単位

表示時刻と表示長さの単位は秒です。半角数字で指定します。
小数点を付加することができます。
数字の末尾に"F"を付けることでフレーム単位で時間指定ができます。
この場合小数点は使用できません。
分による指定はできません。

　●時間指定モード

表示時刻に、直前のテキストコマンドからの相対時間を設定することができます。
表示時刻の前に"+"(プラス)を付けると、
直前のテキストコマンドの終了時刻からの相対時間になります。
表示時刻の前に"*"(アスタリスク)を付けると、
直前のテキストコマンドの開始時刻からの相対時間になります。

表示長さは省略することができます。この場合、字幕の文字数から
自動的に長さが決定されます。
１文字あたりの時間長さはシステムコマンドで変更することができます。
特例として、*0 を指定した時に表示長さを省略すると
直前の字幕の表示長さが使用されます。

２つの数字をカンマではなく"~"(チルダ)で区切ると、
表示長さではなく終了時刻を指定することができます。
ただし、表示時刻より終了時刻が前だとエラーになります。
また、終了時刻に相対時間を使用することはできません。


　●例

@3,5
3秒から5秒間、この字幕を表示する

@ 100F, 10
・100フレームから10秒間、この字幕を表示する
複数行も可能

@10
表示長さを省略可能

@ +2, 5
直前の字幕の終わりから２秒後に表示

@32~36
32秒から36秒まで表示

------------------------------------------------------------

■ システムコマンド

書式パラメータの設定などを行うコマンドです。
":"コロン + コマンド名 + " "(半角スペース) + パラメータ1 + ","(カンマ) + パラメータ2
のように指定します。

コロンとコマンド名の間にスペースを入れることはできません。
コマンド名の後には最低1つのスペースが必要です。
パラメータの前後には任意のスペースを入れても構いません。
タブ文字はすべて半角スペースに置き換えられます。

コマンド名は大文字と小文字を区別しません。
コマンド名に全角文字は使用できません。

システムコマンドは1行に1つです。
1行に複数のシステムコマンドを書いたり、
1つのシステムコマンドを複数行にまたがって書くことはできません。

MMTScriptには、システムコマンドが含まれている必要はありません。

各システムコマンドの詳細は、
後述のシステムコマンドリファレンスを参照してください。


例：

//フォントを指定します
:font	ＤＦＰ中太丸ゴシック体

//フォントの色を指定します
:fontcolor	255,255,255

//太字に設定します
:bold

//縁取りの太さを指定します
:edge 7



------------------------------------------------------------

■コメント

行頭に"//"が付いている行はコメント行として完全に無視されます。
C言語のコメントと違い、行の途中からコメントにすることはできません。


------------------------------------------------------------

■システムコマンドリファレンス


:font フォント名

フォント名を指定します。
初期値は"ＭＳ ゴシック"です。


:size フォントサイズ

フォントの大きさを指定します。
単位はスクリーン高さの半分に対するパーセントです。
初期値は12です。


:fontcolor R,G,B

フォント色を指定します。RGBにはそれぞれ0〜255の整数が入ります。
初期値は255,255,255です。


:bold
:bold_off

太字のオンオフを指定します。パラメータはありません。
初期値はオフです。


:italic
:italic_off

斜体のオンオフを指定します。パラメータはありません。
初期値はオフです。


:underline
:underline_off

下線のオンオフを指定します。パラメータはありません。
初期値はオフです。


:strikeout
:strikeout_off

取り消し線のオンオフを指定します。パラメータはありません。
初期値はオフです。


:pos 横位置, 縦位置

字幕を表示する位置を指定します。
単位はスクリーンの大きさの半分に対するパーセントです。
横位置は左端が-100、中央が0、右端が100
縦位置は下端が-100、中央が0、上端が100 です。


:pos_x 横位置

横位置のみ指定します。
数字の前に"+"(プラス)を付けると現在の指定位置からの
相対位置を指定できます。

:pos_y 縦位置

縦位置のみ指定します。
数字の前に"+"(プラス)を付けると現在の指定位置からの
相対位置を指定できます。


:pos_nextline

直前のテキストコマンドの次の行の位置に移動します。
上揃えでなければ使用できません。
また一度もテキストコマンドが使われていないときは使用できません。


:pos_next

直前のテキストコマンドの続きの位置に移動します。
左揃えでなければ使用できません。
screen コマンドを用いてスクリーンサイズが（少なくともアスペクト比が）
正しく設定されている必要があります。
また一度もテキストコマンドが使われていないときは使用できません。
複数行の字幕には使用しないでください。


:align_left
:align_center
:align_right

それぞれ左揃え、中央揃え、右揃えに設定します。パラメータはありません。
初期値は左揃えです。


:valign_top
:valign_center
:valign_bottom

それぞれ上揃え、中央揃え、下揃えに設定します。パラメータはありません。
初期値は下揃えです。


:margin 横余白, 縦余白

余白を設定します。単位は文字サイズに対するパーセントです。
初期値は 5, 5 です。


:screen スクリーン幅, スクリーン高さ

画面サイズを指定します。
初期値は1280,720です。


:screen_height スクリーン高さ

スクリーンの高さを指定します。
字幕テクスチャの大きさを決めるために使われます。
スクリーンが大きいとテクスチャの解像度も高くなります。
初期値は720です。


:edge エッジ太さ

縁取りのエッジ太さを指定します。単位は文字サイズに対するパーセントです。
0にすると縁取りなしになります。
初期値は6です。


:edgecolor R,G,B

縁取りの色を指定します。RGBにはそれぞれ0〜255の整数が入ります。
初期値は0,0,0です。


:edge_round
:edge_round_off

エッジの角を丸くします。
初期値はオフです。


:shadow 影距離

文字から影の距離を指定します。単位は文字サイズに対するパーセントです。
0にすると影なしになります。
初期値は0です。


:shadowcolor R,G,B

影の色を指定します。RGBにはそれぞれ0〜255の整数が入ります。
初期値は0,0,100です。


:shadowblur ぼかし半径

影および縁取りをぼかす強度を指定します。0で無効です。
ぼかし半径の単位は文字サイズに対するパーセントです。
処理に時間がかかるので注意してください。
最大でも10以下に抑えることを推奨します。
初期値は0です。


:alpha 不透明度

字幕のアルファ値を設定します。0〜1.0 の実数です。
このパラメータはエフェクト側で処理されます。
初期値は1です。


:backcolor R,G,B,A

背景色を設定します。RGBAにはそれぞれ0〜255の整数が入ります。
初期値は 255,255,255,0 です。


:fade フェード時間

字幕のフェードにかかる時間を指定します。単位は秒です。
0にするとフェードなしになります。
初期値は0.5です。


:autotime １文字の時間

字幕の表示長さを省略した場合に用いられる、１文字あたりの時間の長さです。
単位は秒です。
初期値は0.3です。


:timebase 基準時間

タイムベースを設定します。
タイムベースが設定されると、これ以降のテキストコマンドの表示時刻は
すべてタイムベースを基準としたものになります。
例として、タイムベース 5 の状態で @5 のテキストコマンドを使用すると
動画開始から10秒の時点で字幕が表示されます。
シーン切り替えの時などに利用すると、
以降の字幕をシーンの開始からの時間で考えることができます。


:tate
:tate_off

縦書きにします。おまけ機能なのでいろいろ問題が多いです。
もちろん初期値はオフです。


:billboard
:billboard_off

パネルモードにおけるビルボード表示を設定します。
初期値はオフです。


:set セット名

現在の書式情報を記録します。記録した書式はgetコマンドで呼び出せます。
キャラクターごとに書式を変える場合などに利用できます。
セット名は大文字小文字、全角半角が区別されるので注意してください。
同じセット名でこのコマンドを２回使用した場合、上書きされます。


:get セット名

setコマンドで記録した書式を呼び出します。
登録されていないセット名を使うとエラーになります。
ただし、セット名に default を使うと全ての書式がリセットされます。


:skip

次のテキストコマンドをスキップします。
ただし、相対時間の基準としては活きています。
字幕を一時的に非表示にするときなどに利用できます。


:end

MMTScriptの終わりを意味します。必須ではありません。
このコマンド以降はすべてが無視されます。



